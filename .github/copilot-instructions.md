# Copilot Instructions (Minimal)

## Language / Tone
- 返答は日本語。
- 余計な前置きは不要。結論→理由→手順の順で簡潔に。

## Workflow
- 非自明な変更（新機能・複数ファイル改修・大きいリファクタ）のときは、まず「計画」を箇条書きで提示し、こちらの合意を待ってから実装案を出す。
- 変更は小さく段階的に。影響範囲（触る/確認するファイル）を最初に列挙する。

## Code Quality
- 既存のコードスタイル・命名・ディレクトリ構成を最優先で踏襲する。
- 可能な限りイミュータブル（破壊的変更を避ける）。オブジェクト/配列は直接書き換えず新しい値を作る。
- ファイルは小さく保つ（目安200–400行、最大800行）。肥大化しそうなら分割案を提案する。
- `any` は使わない。TypeScript の型安全を優先し、必要なら型定義を追加する。
- コメントは WHY を書く。TODO には背景/リンク（Issue等）があるなら付ける。
- ソース/コメントに絵文字は使わない。

## Error Handling
- 例外・エラーは握りつぶさない。失敗ケースを考慮して分岐を明示する。
- 変更後に壊れやすい箇所（境界値・null/undefined・非同期）を意識して提案する。

## Tests
- 重要ロジックやバグ修正では、可能なら先にテスト（最小の再現ケース）を提案する。
- 実行すべきコマンドは `package.json` を参照し、原則この順で提案する：
  1) lint
  2) typecheck / `tsc --noEmit`
  3) test（存在する場合）

## Output Format
- 変更提案は「ファイルごと」に、追加/修正点が分かる形で出す（差分 or 完成形）。
- 最後に短いチェックリスト（動作確認ポイント・見落としやすい点）を付ける。
